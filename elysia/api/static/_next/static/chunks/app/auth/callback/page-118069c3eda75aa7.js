(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6769],{41373:(e,r,o)=>{Promise.resolve().then(o.bind(o,52872))},45726:(e,r,o)=>{"use strict";o.d(r,{U:()=>n});var a=o(57716);function n(){let e;return(0,a.createBrowserClient)((e="/supabase").startsWith("/")?`${window.location.origin}${e}`:e,"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJyb2xlIjoiYW5vbiIsImlzcyI6InN1cGFiYXNlIiwiaWF0IjoxNzcwODI0OTcwLCJleHAiOjE5Mjg1MDQ5NzB9.hbIOpqCgw-rro9kaZjEQ7T-xZ9qRYvXeS3PmMgq4smw",{cookieOptions:{name:"sb-athena-auth-token"}})}o(41463)},52872:(e,r,o)=>{"use strict";o.r(r),o.d(r,{default:()=>t});var a=o(95155),n=o(12115),i=o(45726);function t(){let[e,r]=(0,n.useState)("Processing authentication..."),o=(0,i.U)();return(0,n.useEffect)(()=>{(async()=>{let e=window.location.hash||"",a=new URLSearchParams(window.location.search),n=a.get("code"),i=a.get("error"),t=a.get("error_description");if(i){let e=new URL("/login",window.location.origin);e.searchParams.set("error",i),t&&e.searchParams.set("error_description",t),window.location.replace(e.toString());return}if(n){try{let{error:e}=await o.auth.exchangeCodeForSession(n);if(e){console.error("[Callback] Code exchange error:",e),r("Authentication failed. Redirecting..."),window.location.replace("/login");return}fetch("/api/auth/sync-profile",{method:"POST",credentials:"include"}).catch(e=>console.error("[Callback] sync-profile failed:",e)),window.location.replace("/")}catch(e){console.error("[Callback] Unexpected error during code exchange:",e),window.location.replace("/login")}return}if(e&&e.includes("access_token=")){let r=new URLSearchParams(e.substring(1)),a=r.get("access_token"),n=r.get("refresh_token");if(a&&n){try{if((await fetch("/api/auth/session",{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({access_token:a,refresh_token:n})})).ok){fetch("/api/auth/sync-profile",{method:"POST",credentials:"include"}).catch(e=>console.error("[Callback] sync-profile failed:",e)),window.history.replaceState(null,"","/auth/callback"),window.location.replace("/");return}}catch(e){console.error("[Callback] /api/auth/session failed:",e)}let{error:e}=await o.auth.setSession({access_token:a,refresh_token:n});if(!e){fetch("/api/auth/sync-profile",{method:"POST",credentials:"include"}).catch(e=>console.error("[Callback] sync-profile failed:",e)),window.history.replaceState(null,"","/auth/callback"),window.location.replace("/");return}console.error("[Callback] setSession error:",e)}window.location.replace("/login"+e);return}if(e)return window.location.replace("/login"+e);let c=window.location.search||"";c?window.location.replace("/login"+c):window.location.replace("/")})()},[o.auth]),(0,a.jsxs)("div",{className:"h-screen w-screen flex flex-col items-center justify-center bg-background text-primary gap-4",children:[(0,a.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"}),(0,a.jsx)("p",{children:e})]})}}},e=>{e.O(0,[7716,8441,3794,7358],()=>e(e.s=41373)),_N_E=e.O()}]);